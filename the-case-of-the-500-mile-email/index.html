<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="stylesheet" href="/static/styles/colors.css" />
  <link rel="stylesheet" href="/static/styles/global.css" />
  <link rel="stylesheet" href="/static/styles/code.css" />

  <link rel="apple-touch-icon" sizes="180x180" href="/static/icon/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/static/icon/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/static/icon/favicon-16x16.png" />
  <link rel="manifest" href="/static/icon/site.webmanifest" />
  <link rel="mask-icon" href="/static/icon/safari-pinned-tab.svg" color="#bd93f9" />
  <link rel="shortcut icon" href="/static/icon/favicon.ico" />
  <meta name="msapplication-TileColor" content="#603cba" />
  <meta name="msapplication-config" content="/static/icon/browserconfig.xml" />
  <meta name="theme-color" content="#282A36" />


  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta charset="UTF-8" />
  <title>notes: the case of the 500-mile email</title>
</head>

<body>
  <nav>

  
    <div class="main-icon">
      <a href="/">
        <img src="/static/icon/icon.png" alt="notes" height="100">
      </a>
    </div>

    <div class="nav-segments-container">
      <div class="nav-segments">
        

        <div class="flex flex-col text-left nav-links">
          <a href="/folklore" class="activated-link">Folklore</a>
          
          
          <a href="/bookmarks">Bookmarks</a>
          
          
          
          <a href="/fiction">Fiction</a>
          
          
          
          
          
          
          <a href="/lines">Lines</a>
          
          
          
          <a href="/problems">Problems</a>
          
          
          
          <a href="/templates">Templates</a>
          
          
        </div>
        

        

        <div class="flex flex-col text-left nav-links">
          <a href="/the-case-of-the-500-mile-email" class="activated-link">The Case of the 500-Mile Email</a>
          
          
          <a href="/10-rules-of-internet">10 Rules of Internet</a>
          
          
          
          <a href="/a-conspiracy-to-kill-ie6">A Conspiracy To Kill IE6</a>
          
          
          
          <a href="/a-story-about-magic">A Story About 'Magic'</a>
          
          
          
          <a href="/alice-in-modeland">Alice in Modeland</a>
          
          
          
          <a href="/aliens-and-calendars">Aliens and Calendars</a>
          
          
          
          <a href="/amazons-first-job-posting">Amazon's First Job Posting</a>
          
          
          
          <a href="/bell-labs-productivity-mystery">Bell Labs' Productivity Mystery</a>
          
          
          
          <a href="/best-practices-for-time-travellers">Best Practices for Time Travellers</a>
          
          
          
          <a href="/bill-gates-tries-to-install-windows-movie-maker">Bill Gates Tries To Install Windows Movie Maker</a>
          
          
          
          <a href="/bill-gates-wrote-fat-on-an-airplane">Bill Gates Wrote FAT on an Airplane</a>
          
          
          
          <a href="/c-locale-braindeath">C Locale Braindeath</a>
          
          
          
          <a href="/cannot-simultaneously-fix-and-keep-job.-therefore-wont-fix.">Cannot simultaneously fix and keep job. Therefore, won't fix.</a>
          
          
          
          <a href="/christ-mcdonald">Christ McDonald</a>
          
          
          
          <a href="/competing-with-gpt">Competing with GPT</a>
          
          
          
          <a href="/context-menu-hell">Context Menu Hell</a>
          
          
          
          <a href="/digg-v4">Digg v4</a>
          
          
          
          <a href="/dispatch-from-the-cyberpunk-city">Dispatch From the Cyberpunk City</a>
          
          
          
          <a href="/do-things-tell-people">Do Things, Tell People</a>
          
          
          
          <a href="/ellsbergs-advice-for-kissinger">Ellsberg's Advice For Kissinger</a>
          
          
          
          <a href="/factory-factory-factory">Factory Factory Factory</a>
          
          
          
          <a href="/file-over-app">File Over App</a>
          
          
          
          <a href="/guerilla-open-access-manifesto">Guerilla Open Access Manifesto</a>
          
          
          
          <a href="/heaven-banning">Heaven Banning</a>
          
          
          
          <a href="/incomplete-list-of-mistakes-in-the-design-of-css">Incomplete List of Mistakes in the Design of CSS</a>
          
          
          
          <a href="/jsx-react-native-and-typescript">JSX, React Native, and TypeScript</a>
          
          
          
          <a href="/kurt-vonnegut-grades">Kurt Vonnegut Grades</a>
          
          
          
          <a href="/larry-page-builds-a-web-robot">Larry Page Builds a Web Robot</a>
          
          
          
          <a href="/life-of-an-oracle-developer">Life of an Oracle Developer</a>
          
          
          
          <a href="/man-spends-entire-career-mastering-crappy-codebase">Man Spends Entire Career Mastering Crappy Codebase</a>
          
          
          
          <a href="/no-coffee-==-no-job">No Coffee == No Job</a>
          
          
          
          <a href="/no-dogs-were-harmed-in-the-making-of-this-app">No dogs were harmed in the making of this app</a>
          
          
          
          <a href="/not-a-real-engineer">Not a real engineer</a>
          
          
          
          <a href="/on-the-origin-of-emacs">On the Origin of Emacs</a>
          
          
          
          <a href="/on-the-origin-of-toots">On the Origin of Toots</a>
          
          
          
          <a href="/openoffice-cant-print-on-tuesdays">OpenOffice Can't Print on Tuesdays</a>
          
          
          
          <a href="/oracle-as-lawnmower">Oracle as Lawnmower</a>
          
          
          
          <a href="/originality-not-required">Originality Not Required</a>
          
          
          
          <a href="/psd-is-not-my-favourite-file-format">PSD is not my favourite file format</a>
          
          
          
          <a href="/please-drink-verification-can">Please Drink Verification Can</a>
          
          
          
          <a href="/pocket-veto">Pocket Veto</a>
          
          
          
          <a href="/price-of-chatgpts-api-vs-human">Price of ChatGPT's API vs Human</a>
          
          
          
          <a href="/regular-expressions-and-html">Regular Expressions and HTML</a>
          
          
          
          <a href="/rob-pikes-5-rules-of-programming">Rob Pike's 5 Rules of Programming</a>
          
          
          
          <a href="/rob-pikes-lesson-in-shortcuts">Rob Pike's Lesson in Shortcuts</a>
          
          
          
          <a href="/sre-threats">SRE Threats</a>
          
          
          
          <a href="/steve-yegges-tale-of-geoworks">Steve Yegge's Tale of Geoworks</a>
          
          
          
          <a href="/superstitious-encoding">Superstitious Encoding</a>
          
          
          
          <a href="/the-bitter-lesson">The Bitter Lesson</a>
          
          
          
          <a href="/the-cab-ride-ill-never-forget">The Cab Ride I'll Never Forget</a>
          
          
          
          
          
          
          <a href="/the-crawford-principles">The Crawford Principles</a>
          
          
          
          <a href="/the-damned-can-now-play-three-chords">The Damned Can Now Play Three Chords</a>
          
          
          
          <a href="/the-nazi-bar-problem">The Nazi Bar Problem</a>
          
          
          
          <a href="/the-patron-saint-of-yak-shaves">The Patron Saint of Yak Shaves</a>
          
          
          
          <a href="/the-reddit-long-con">The Reddit Long Con</a>
          
          
          
          <a href="/the-smallest-quine">The Smallest Quine</a>
          
          
          
          <a href="/the-unknown-citizen">The Unknown Citizen</a>
          
          
          
          <a href="/the-web-without-ad-blockers">The Web Without Ad Blockers</a>
          
          
          
          <a href="/the-bin-split">The bin Split</a>
          
          
          
          <a href="/thoughts-on-flash">Thoughts On Flash</a>
          
          
          
          <a href="/tiktoks-enshittification">TikTok's Enshittification</a>
          
          
          
          <a href="/time-traveller-on-irc">Time Traveller on IRC</a>
          
          
          
          <a href="/unix-recovery-legend">Unix Recovery Legend</a>
          
          
          
          <a href="/usenet-post-warning">Usenet Post Warning</a>
          
          
          
          <a href="/virtues-of-a-good-programmer">Virtues of a Good Programmer</a>
          
          
          
          <a href="/we-have-no-moat-and-neither-does-openai">We Have No Moat, And Neither Does OpenAI</a>
          
          
          
          <a href="/when-is-midnight">When Is Midnight</a>
          
          
          
          <a href="/worse-is-better">Worse is Better</a>
          
          
          
          <a href="/yak-shaving">Yak Shaving</a>
          
          
          
          <a href="/carproblems.txt">carproblems.txt</a>
          
          
        </div>
        

        
      </div>
    </div>


  </nav>
  <main>
    <header>
      <h1>The Case of the 500-Mile Email</h1>
    </header>
    <article><p>The following is the 500-mile email story in <a href="http://www.ibiblio.org/harris/500milemail.html">the form it originally appeared</a>, in a post to sage-members on Sun, 24 Nov 2002. He later wrote an <a href="http://www.ibiblio.org/harris/500milemail-faq.html">FAQ</a>.</p>
<hr />
<div class="highlight"><pre><span></span><code>From trey@sage.org Fri Nov 29 18:00:49 2002
Date: Sun, 24 Nov 2002 21:03:02 -0500 (EST)
From: Trey Harris &lt;trey@sage.org&gt;
To: sage-members@sage.org
Subject: The case of the 500-mile email (was RE: [SAGE] Favorite impossible
    task?)

Here&#39;s a problem that *sounded* impossible...  I almost regret posting the
story to a wide audience, because it makes a great tale over drinks at a
conference. :-)  The story is slightly altered in order to protect the
guilty, elide over irrelevant and boring details, and generally make the
whole thing more entertaining.

I was working in a job running the campus email system some years ago when
I got a call from the chairman of the statistics department.

&quot;We&#39;re having a problem sending email out of the department.&quot;

&quot;What&#39;s the problem?&quot; I asked.

&quot;We can&#39;t send mail more than 500 miles,&quot; the chairman explained.

I choked on my latte.  &quot;Come again?&quot;

&quot;We can&#39;t send mail farther than 500 miles from here,&quot; he repeated.  &quot;A
little bit more, actually.  Call it 520 miles.  But no farther.&quot;

&quot;Um... Email really doesn&#39;t work that way, generally,&quot; I said, trying to
keep panic out of my voice.  One doesn&#39;t display panic when speaking to a
department chairman, even of a relatively impoverished department like
statistics.  &quot;What makes you think you can&#39;t send mail more than 500
miles?&quot;

&quot;It&#39;s not what I *think*,&quot; the chairman replied testily.  &quot;You see, when
we first noticed this happening, a few days ago--&quot;

&quot;You waited a few DAYS?&quot; I interrupted, a tremor tinging my voice.  &quot;And
you couldn&#39;t send email this whole time?&quot;

&quot;We could send email.  Just not more than--&quot;

&quot;--500 miles, yes,&quot; I finished for him, &quot;I got that.  But why didn&#39;t you
call earlier?&quot;

&quot;Well, we hadn&#39;t collected enough data to be sure of what was going on
until just now.&quot;  Right.  This is the chairman of *statistics*. &quot;Anyway, I
asked one of the geostatisticians to look into it--&quot;

&quot;Geostatisticians...&quot;

&quot;--yes, and she&#39;s produced a map showing the radius within which we can
send email to be slightly more than 500 miles.  There are a number of
destinations within that radius that we can&#39;t reach, either, or reach
sporadically, but we can never email farther than this radius.&quot;

&quot;I see,&quot; I said, and put my head in my hands.  &quot;When did this start?  A
few days ago, you said, but did anything change in your systems at that
time?&quot;

&quot;Well, the consultant came in and patched our server and rebooted it.
But I called him, and he said he didn&#39;t touch the mail system.&quot;

&quot;Okay, let me take a look, and I&#39;ll call you back,&quot; I said, scarcely
believing that I was playing along.  It wasn&#39;t April Fool&#39;s Day.  I tried
to remember if someone owed me a practical joke.

I logged into their department&#39;s server, and sent a few test mails.  This
was in the Research Triangle of North Carolina, and a test mail to my own
account was delivered without a hitch.  Ditto for one sent to Richmond,
and Atlanta, and Washington.  Another to Princeton (400 miles) worked.

But then I tried to send an email to Memphis (600 miles).  It failed.
Boston, failed.  Detroit, failed.  I got out my address book and started
trying to narrow this down.  New York (420 miles) worked, but Providence
(580 miles) failed.

I was beginning to wonder if I had lost my sanity.  I tried emailing a
friend who lived in North Carolina, but whose ISP was in Seattle.
Thankfully, it failed.  If the problem had had to do with the geography of
the human recipient and not his mail server, I think I would have broken
down in tears.

Having established that--unbelievably--the problem as reported was true,
and repeatable, I took a look at the sendmail.cf file.  It looked fairly
normal.  In fact, it looked familiar.

I diffed it against the sendmail.cf in my home directory.  It hadn&#39;t been
altered--it was a sendmail.cf I had written.  And I was fairly certain I
hadn&#39;t enabled the &quot;FAIL_MAIL_OVER_500_MILES&quot; option.  At a loss, I
telnetted into the SMTP port.  The server happily responded with a SunOS
sendmail banner.

Wait a minute... a SunOS sendmail banner?  At the time, Sun was still
shipping Sendmail 5 with its operating system, even though Sendmail 8 was
fairly mature.  Being a good system administrator, I had standardized on
Sendmail 8.  And also being a good system administrator, I had written a
sendmail.cf that used the nice long self-documenting option and variable
names available in Sendmail 8 rather than the cryptic punctuation-mark
codes that had been used in Sendmail 5.

The pieces fell into place, all at once, and I again choked on the dregs
of my now-cold latte.  When the consultant had &quot;patched the server,&quot; he
had apparently upgraded the version of SunOS, and in so doing
*downgraded* Sendmail.  The upgrade helpfully left the sendmail.cf
alone, even though it was now the wrong version.

It so happens that Sendmail 5--at least, the version that Sun shipped,
which had some tweaks--could deal with the Sendmail 8 sendmail.cf, as most
of the rules had at that point remained unaltered.  But the new long
configuration options--those it saw as junk, and skipped.  And the
sendmail binary had no defaults compiled in for most of these, so, finding
no suitable settings in the sendmail.cf file, they were set to zero.

One of the settings that was set to zero was the timeout to connect to the
remote SMTP server.  Some experimentation established that on this
particular machine with its typical load, a zero timeout would abort a
connect call in slightly over three milliseconds.

An odd feature of our campus network at the time was that it was 100%
switched.  An outgoing packet wouldn&#39;t incur a router delay until hitting
the POP and reaching a router on the far side.  So time to connect to a
lightly-loaded remote host on a nearby network would actually largely be
governed by the speed of light distance to the destination rather than by
incidental router delays.

Feeling slightly giddy, I typed into my shell:

$ units
1311 units, 63 prefixes

You have: 3 millilightseconds
You want: miles
        * 558.84719
        / 0.0017893979

&quot;500 miles, or a little bit more.&quot;

Trey Harris
-- 
I&#39;m looking for work.  If you need a SAGE Level IV with 10 years Perl,
tool development, training, and architecture experience, please email me
at trey@sage.org.  I&#39;m willing to relocate for the right opportunity.
</code></pre></div></article>

    

    
  </main>
  <footer>
    <a href="https://github.dev/pavo-etc/notes/blob/main/./notes/Archive/Folklore/The Case of the 500-Mile Email.md">edit</a> -
    <a href="/gecos">random</a> -
    <a href="/recent-changes">updates</a> -
    <a href="/tags">tags</a> -
    <a href="/sitemap">sitemap</a>
  </footer>
  
</body>

</html>